services:
  php:
    image: yiisoftware/yii2-php:8.5-apache-latest
    volumes:
      - ~/.composer-docker/cache:/root/.composer/cache:delegated
      - ./:/app:delegated
      - runtime:/app/runtime
      - assets:/app/web/assets
    # ensure the writable directories are owned by the web user on every start.
    command: [
      "bash",
      "-lc",
      "chown -R www-data:www-data /app/runtime /app/web/assets && chmod -R ug+rwX /app/runtime /app/web/assets && exec apache2-foreground",
    ]
    ports:
      - '8000:80'

volumes:
  runtime:
  assets:
